plugins {
  id 'org.hidetake.swagger.generator' version '2.18.1'
}

apply {
  plugin 'java'
}

apply plugin: 'org.springframework.boot'
apply plugin: 'io.spring.dependency-management'

dependencies {
  compile project(':spica-server:spica-server-commons')
  compile 'io.swagger:swagger-annotations:1.5.22'
  compile ("org.springframework.boot:spring-boot-starter-data-jpa")

  compile('org.springframework.boot:spring-boot-starter-web')

  swaggerCodegen 'io.swagger.codegen.v3:swagger-codegen-cli:3.0.5'  // or Swagger Codegen V3

}

jar.enabled = true
bootJar.enabled = false

swaggerSources {
  spicaServerChat {
    inputFile = project.file('spica-server-chat.yaml')
    code {
      language = 'spring'
      components = ['models', 'apis']
      additionalProperties = [interfaceOnly:'true']
      rawOptions = ['--api-package=org.spica.server.chat.api', '--model-package=org.spica.server.chat.model']
    }
  }
}

sourceSets.main.java.srcDir "${swaggerSources.spicaServerChat.code.outputDir}/src/main/java"
sourceSets.main.resources.srcDir "${swaggerSources.spicaServerChat.code.outputDir}/src/main/resources"
tasks.compileJava.dependsOn tasks.generateSwaggerCode